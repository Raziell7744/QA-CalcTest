#!/usr/bin/perl
## Initially generated by Win32-GuiTest Recorder (v1.03)

## Pragmas/Directives
use strict;
use warnings;

## Imports
use Win32::GuiTest qw/:ALL/;

$Win32::GuiTest::debug = 0; # Set to "1" to enable debug output.

## Variables/Constants
my $fgWindow = 0; # Foreground Window

## Main/Core
#my ($number, $operation, $number2) = @ARGV;
my @arr;
my @hwnds;

#if (not defined $number or not defined $number2 or not defined $operation)
#{
#	die "One of the parameter is missing";
#}

system "start calc.exe";
sleep(1);
@arr = FindWindowLike(undef, "Calculator");

SetForegroundWindow($arr[0]);
SetFocus($arr[0]);

my $filename = '.\data.txt';
my $resultsFile = '.\results.txt';
# open source file for reading
open(SRC, '<:encoding(UTF-8)', $filename)
  or die "Could not open file '$filename' $!";
  
# open destination file for writing
open(DES,'>:encoding(UTF-8)',$resultsFile)
   or die "Could not open file '$resultsFile' $!";

SendKeys("C");
my $indexRow = 1;
print DES "Test Result\n";
while (my $row = <SRC>) {
  chomp $row;
  if ($row ne 'C') {
	print DES $row, " ";
  }
  SendKeys("{$row}");
  
  if ($row eq '=') {
	@hwnds = GetChildWindows(@arr);
	for (@hwnds) {
		my $text = GetWindowText($_);
		if ($text ne '') {
			print DES $text, "\n";
			$indexRow = $indexRow + 1;
		}
	}
  }
  sleep(1);
  print "$row\n";
}
#SendKeys($number);
#sleep(1);
#SendKeys("{$operation}");
#sleep(1);
#SendKeys($number2);
#sleep(1);
#SendKeys("=");
## Subroutines
